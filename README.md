# Contributiong guide

Разрботка одинаково хорошо работает на linux/MacOs/Windows
Настроены pre-commit хуки - гавно запушить не дадут.
Если линтер не пашет, пожалуйста установи linter и pretter в свой vscode и убедись, что они пашут.

```
Набери @recomended в extention вкладке, и поставь все для workspace
```

## Yarn

Используем исключительно yarn - не вздумай впихнуть npm!
Работаем на 14 версии nodejs - будь умен, используй nvm (даже под windows)
Если на лине можешь вообще бахнуть

```
nvm install && nvm use
```

Нужная нода волшебно прилетит
Или еще умнее)

```
yarn nvm
```

На винде бахать придется все руками

```
nvm install 14.15.2
nvm use 14.15.2
```

Подымать базу и бекенд для разработки фронта не надо - можешь коннектиться к тестовому стенду, там отключены cors.
Для этого достаточно поменять урл тут https://gitlab.com/wishlist-wes/wishlist-mono/-/blob/dev/src/client/api/axiosPro.ts#L10

## Подтягиваем зависимости

```
yarn
```

Если будет не та нода - на тебя наругаются - поставь нужную! (см engines в package.json)

## Стартуем приложение

`yarn client:dev` - это правильный путь старта приложения для разработки.
не вздумай использовать npm. Погляди как сделаны скрипты в package.json - это на многое ответит.

## Мне нужно добавить зависимость

Докидывай ее только в dev-dependencies! сделать это можно `yarn add -D name @types/name`
Не забывай про типы, ставь их сразу. Если удаляешь, не забудь удалить и типы, не усложняй сборку.

## Как запросы на бек сделать руками

Во первых есть сваггер - можно там (там удобно авторизироваться)
Можно импортнуть json из сваггера в постман, он подтянет всю ту же инфу, елси так удобнее.

## Как работать с ветками в гите

Задачу пилим в ветке под задачу, оформлять ветки вида lila/64 по номеру задачи, или lila/compression_enabled по имени задачи, как больше нравится.
После завершения, можно отдавать на ревью, и если все ок, мерджим в мастер. Да с мердж коммитом, и сохранением истории.
Ветку за собой удаляем. (локальную и на origin)

## CI/CI

Как только пушнешь в репозиторий, в ветку dev - пойдет сборка на CI и фронта и бека (у нас монорепозиторий же)
Да, мы каждый раз билдим оба артефакта, даже если ниче не поменялось (докер это нивелирует)
После чего это автоматом раскатывается на стейдж - т.е dev - всегда раскатан! Учитывай это.
На прод катим только по договоренности и только руками.

## Я хочу поднять бек

Нужна база данных - в интернет не торчит, и общей нет. "сама не поднимается". Поднять можно через `docker run -d -p 27017:27017 mongo`
Потом нужно подкинуть конфигу. Для этого достаточно скидать все из .env.example в .env (да его нет - надо создать и не коммитить)
Ну и просто `yarn server:dev` и все готово, свой бек.
В перспективе, конфигурация фронта будет такая же как у бекенда.

Почитай про 12 факторное приложение - мы пишем в полной соответствии с этой парадигме
Конфигурация идет через файл .env который нужно создать самостоятельно (без всяких расширений) и да он в gitignore - там же ключи!!
Можешь скопировать инфу о том "че там писать" из файла .env.example

## Что то на деовпсерском

#### Телеметрия

Пока мало, есть графана, и Influx под капотом, и Nginx на выходе. Этого очень мало.
В перспективе будем втаскивать jaeger или apm и другую трассировку, логи, и метрики.

#### Хостинг

Пока на малинке (все) но в докере. так что можно без вопросов обновлять что угодно, данные не пропадут, базу наполнять не надо.
Нагрузочное на малину гонять смысла не много)

#### Алерты

Пока только на графане, через метрики инфлюкса, что не очень - зато легко интегрировать со слаком и телегой. (edited)
